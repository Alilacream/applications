{"ast":null,"code":"var _jsxFileName = \"/home/ali/Desktop/applications/src/ExcelWordExporter.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef } from \"react\";\nimport * as XLSX from \"xlsx-js-style\";\nimport { saveAs } from \"file-saver\";\nimport PizZip from \"pizzip\";\nimport Docxtemplater from \"docxtemplater\";\n// dectects tauri app folder\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst isTauri = () => {\n  return typeof window !== \"undefined\" && \"__TAURI__\" in window && typeof window.__TAURI__ !== \"undefined\";\n};\n// ðŸ‘‡ Universal file saver â€” works in browser AND Tauri\nasync function saveFile(blob, fileName) {\n  try {\n    if (isTauri()) {\n      const {\n        save\n      } = await import(\"@tauri-apps/api/dialog\");\n      const {\n        writeBinaryFile\n      } = await import(\"@tauri-apps/api/fs\");\n      const filePath = await save({\n        defaultPath: fileName,\n        filters: [{\n          name: \"Files\",\n          extensions: [\"xlsx\", \"docx\"]\n        }]\n      });\n      if (filePath) {\n        const arrayBuffer = await blob.arrayBuffer();\n        await writeBinaryFile(filePath, Array.from(new Uint8Array(arrayBuffer)));\n      }\n    } else {\n      // ðŸŒ Browser â†’ trigger \"Save As\" with FileSaver\n      const {\n        saveAs\n      } = await import(\"file-saver\");\n      saveAs(blob, fileName);\n    }\n  } catch (error) {\n    console.error(\"Save failed:\", error);\n  }\n}\n\n// ðŸ‘‡ Helper function to normalize strings (remove accents, lowercase, clean spaces)\nconst normalizeString = str => {\n  if (typeof str !== \"string\") return \"\";\n  return str.normalize(\"NFD\") // Split accented characters\n  .replace(/[\\u0300-\\u036f]/g, \"\") // Remove diacritics\n  .toLowerCase().trim().replace(/\\s+/g, \" \"); // Collapse spaces\n};\nconst ExcelWordExporter = () => {\n  _s();\n  const [data, setData] = useState([]);\n  const [selectedRows, setSelectedRows] = useState(new Set());\n  const [fileName, setFileName] = useState(\"\");\n  const [showError, setShowError] = useState(false);\n  const [errorMessage, setErrorMessage] = useState(\"\");\n  const fileInputRef = useRef(null);\n\n  // Handle file import\n  const handleFileImport = () => {\n    var _fileInputRef$current;\n    (_fileInputRef$current = fileInputRef.current) === null || _fileInputRef$current === void 0 ? void 0 : _fileInputRef$current.click();\n  };\n\n  // Handles any given extra column at the beginning so we can find the first column index:\n  // NÂ° PRIX\n  const handleFileChange = event => {\n    const file = event.target.files[0];\n    if (!file) return;\n    const validExtensions = [\".xlsx\", \".xls\", \".csv\"];\n    const fileExtension = file.name.toLowerCase().slice(file.name.lastIndexOf(\".\"));\n    if (!validExtensions.includes(fileExtension)) {\n      setErrorMessage(`Invalid file type. Please select an Excel file (.xlsx, .xls, or .csv). You selected: ${fileExtension}`);\n      setShowError(true);\n      event.target.value = \"\";\n      return;\n    }\n    const reader = new FileReader();\n    reader.onload = e => {\n      try {\n        const data = new Uint8Array(e.target.result);\n        const workbook = XLSX.read(data, {\n          type: \"array\"\n        });\n        const firstSheetName = workbook.SheetNames[0];\n        const worksheet = workbook.Sheets[firstSheetName];\n\n        // âœ… Read sheet as 2D array â€” with empty string fallback\n        const range = XLSX.utils.decode_range(worksheet[\"!ref\"]);\n        const raw_data = [];\n        for (let R = range.s.r; R <= range.e.r; ++R) {\n          const row = [];\n          for (let C = range.s.c; C <= range.e.c; ++C) {\n            const cell_address = {\n              c: C,\n              r: R\n            };\n            const cell_ref = XLSX.utils.encode_cell(cell_address);\n            const cell = worksheet[cell_ref];\n            row.push(cell ? cell.w || cell.v : \"\"); // â† Use formatted (w) or raw (v) value\n          }\n          raw_data.push(row);\n        }\n\n        // âœ… Find header row â€” look for \"NÂ° PRIX\"\n        let headerRowIndex = -1;\n        for (let i = 0; i < raw_data.length; i++) {\n          const row = raw_data[i];\n          if (Array.isArray(row) && row.some(cell => typeof cell === \"string\" && normalizeString(cell).includes(\"nÂ° prix\"))) {\n            headerRowIndex = i;\n            break;\n          }\n        }\n        if (headerRowIndex === -1) {\n          throw new Error(\"Could not detect header row. Please make sure 'NÂ° PRIX' column exists.\");\n        }\n\n        // âœ… Extract headers and data rows\n        const headers = raw_data[headerRowIndex];\n        const dataRows = raw_data.slice(headerRowIndex + 1);\n\n        // âœ… Convert to array of objects â€” with normalized keys\n        const jsonData = dataRows.filter(row => row && row.length > 0).map(row => {\n          const obj = {};\n          headers.forEach((header, index) => {\n            const key = normalizeString(header || `col_${index}`);\n            obj[key] = index < row.length ? row[index] : \"\";\n          });\n          return obj;\n        }).filter(obj => Object.values(obj).some(val => String(val).trim() !== \"\"));\n        if (jsonData.length === 0) {\n          throw new Error(\"No valid data found after header row.\");\n        }\n        setData(jsonData);\n        setFileName(file.name);\n        setShowError(false);\n      } catch (error) {\n        console.error(\"File Read Error:\", error);\n        setErrorMessage(error.message || \"Error reading Excel file. Please check format.\");\n        setShowError(true);\n      }\n    };\n    reader.readAsArrayBuffer(file);\n  };\n  const closeError = () => {\n    setShowError(false);\n    setErrorMessage(\"\");\n  };\n\n  // Toggle row selection\n  const toggleRowSelection = index => {\n    const newSelected = new Set(selectedRows);\n    if (newSelected.has(index)) {\n      newSelected.delete(index);\n    } else {\n      newSelected.add(index);\n    }\n    setSelectedRows(newSelected);\n  };\n\n  // Get selected data\n  const getSelectedData = () => {\n    return data.filter((_, index) => selectedRows.has(index));\n  };\n\n  // ðŸŽ¨ Excel Styles\n  const headerStyle = {\n    fill: {\n      fgColor: {\n        rgb: \"43A047\"\n      }\n    },\n    // Dark blue\n    font: {\n      color: {\n        rgb: \"000000\"\n      },\n      bold: true,\n      sz: 15\n    },\n    alignment: {\n      horizontal: \"center\",\n      vertical: \"center\",\n      wrapText: true\n    },\n    border: {\n      top: {\n        style: \"thin\",\n        color: {\n          rgb: \"000000\"\n        }\n      },\n      bottom: {\n        style: \"thin\",\n        color: {\n          rgb: \"000000\"\n        }\n      },\n      left: {\n        style: \"thin\",\n        color: {\n          rgb: \"000000\"\n        }\n      },\n      right: {\n        style: \"thin\",\n        color: {\n          rgb: \"000000\"\n        }\n      }\n    }\n  };\n  const cellStyle = {\n    alignment: {\n      horizontal: \"left\",\n      vertical: \"top\",\n      wrapText: true\n    },\n    border: {\n      top: {\n        style: \"thin\",\n        color: {\n          rgb: \"D9D9D9\"\n        }\n      },\n      bottom: {\n        style: \"thin\",\n        color: {\n          rgb: \"D9D9D9\"\n        }\n      },\n      left: {\n        style: \"thin\",\n        color: {\n          rgb: \"D9D9D9\"\n        }\n      },\n      right: {\n        style: \"thin\",\n        color: {\n          rgb: \"D9D9D9\"\n        }\n      }\n    },\n    font: {\n      sz: 11\n    }\n  };\n  const numberStyle = {\n    ...cellStyle,\n    alignment: {\n      horizontal: \"right\",\n      vertical: \"top\"\n    },\n    numFmt: \"#,##0.00\"\n  };\n\n  // Export Excel (without description) â€” with sequential ID reset + STYLING\n  const exportExcelFile = async () => {\n    const selected = getSelectedData();\n    if (selected.length === 0) {\n      setErrorMessage(\"No rows selected. Please select at least one row.\");\n      setShowError(true);\n      return;\n    }\n    try {\n      // Detect columns dynamically â€” using normalized search\n      const parseNumber = value => {\n        const num = parseFloat(value);\n        return !isNaN(num) ? num : 0;\n      };\n      const nPrixCol = Object.keys(data[0]).find(col => normalizeString(col).includes(\"nÂ° prix\")) || normalizeString(\"NÂ° Prix\");\n      const titleCol = Object.keys(data[0]).find(col => normalizeString(col).includes(\"designation\")) || normalizeString(\"designation des ouvrages\");\n      const unitCol = Object.keys(data[0]).find(col => normalizeString(col).includes(\"unite\")) || normalizeString(\"unite\");\n      const qtyCol = Object.keys(data[0]).find(col => normalizeString(col).includes(\"quantite\")) || normalizeString(\"quantites\");\n      const priceCol = Object.keys(data[0]).find(col => normalizeString(col).includes(\"p.u\")) || normalizeString(\"p.u dh.ht\");\n      const totalCol = Object.keys(data[0]).find(col => normalizeString(col).includes(\"montant total h.t\")) || normalizeString(\"Montant total H.T\");\n\n      // Prepare data\n      const excelData = selected.map(row => {\n        const qty = parseNumber(row[qtyCol]);\n        const price = parseNumber(row[priceCol]);\n        const totalFromSource = parseNumber(row[totalCol]);\n        return {\n          \"NÂ°Prix\": row[nPrixCol] || \"\",\n          // â† PRESERVE ORIGINAL VALUE (A, a, 1, 2, B, etc.)\n          DÃ©signation: row[titleCol] || \"Sans Titre\",\n          UnitÃ©: row[unitCol] || \"\",\n          QuantitÃ©: qty,\n          \"P.U DH.HT\": price,\n          \"Montant Total HT\": totalFromSource || qty * price\n        };\n      });\n\n      // Create worksheet\n      const ws = XLSX.utils.json_to_sheet(excelData, {\n        skipHeader: true\n      });\n\n      // Define columns\n      const headers = [\"NÂ°Prix\", \"DÃ©signation\", \"UnitÃ©\", \"QuantitÃ©\", \"P.U DH.HT\", \"Montant Total HT\"];\n      const columns = [{\n        wch: 8\n      },\n      // NÂ°Prix\n      {\n        wch: 40\n      },\n      // DÃ©signation\n      {\n        wch: 10\n      },\n      // UnitÃ©\n      {\n        wch: 12\n      },\n      // QuantitÃ©\n      {\n        wch: 15\n      },\n      // P.U DH.HT\n      {\n        wch: 18\n      } // Montant Total HT\n      ];\n      ws[\"!cols\"] = columns;\n\n      // Add styled headers\n      headers.forEach((header, colIndex) => {\n        const cellAddress = XLSX.utils.encode_cell({\n          r: 0,\n          c: colIndex\n        });\n        ws[cellAddress] = {\n          v: header,\n          s: headerStyle\n        };\n      });\n\n      // Style data cells\n      for (let rowIndex = 1; rowIndex <= excelData.length; rowIndex++) {\n        for (let colIndex = 0; colIndex < headers.length; colIndex++) {\n          const cellAddress = XLSX.utils.encode_cell({\n            r: rowIndex,\n            c: colIndex\n          });\n          if (!ws[cellAddress]) continue;\n          if ([3, 4, 5].includes(colIndex)) {\n            // Numeric columns\n            ws[cellAddress].s = numberStyle;\n            ws[cellAddress].t = \"n\";\n            ws[cellAddress].v = Number(ws[cellAddress].v);\n          } else {\n            ws[cellAddress].s = cellStyle;\n          }\n        }\n      }\n\n      // Finalize and export\n      const wb = XLSX.utils.book_new();\n      XLSX.utils.book_append_sheet(wb, ws, \"Selected Projects\");\n      const exportFileName = fileName ? `export_${fileName.replace(/\\.[^/.]+$/, \"\")}.xlsx` : \"project_export.xlsx\";\n\n      // âœ… START REPLACEMENT â€” Replace XLSX.writeFile with this block\n      // âœ… Generate buffer (same as before)\n      const excelBuffer = XLSX.write(wb, {\n        bookType: \"xlsx\",\n        type: \"array\"\n      });\n      const uint8Array = new Uint8Array(excelBuffer);\n\n      // âœ… Use universal saver\n      const success = await saveFile(uint8Array, exportFileName, \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\");\n      if (!success) {\n        setErrorMessage(\"Export canceled by user.\");\n        setShowError(true);\n        return;\n      }\n      alert(`âœ… Excel exported successfully!`);\n\n      // âœ… END REPLACEMENT\n    } catch (error) {\n      console.error(\"Export Excel Error:\", error);\n      setErrorMessage(\"Error exporting Excel file.\");\n      setShowError(true);\n    }\n  };\n\n  // Export Word (with description) â€” FIXED\n  const exportWordFile = async () => {\n    const selected = getSelectedData();\n    if (selected.length === 0) {\n      setErrorMessage(\"No rows selected. Please select at least one row.\");\n      setShowError(true);\n      return;\n    }\n    try {\n      // Load the official template\n      const templateResponse = await fetch(\"/templates/ROYAUME_DU_MAROC.docx\");\n      if (!templateResponse.ok) {\n        setErrorMessage(\"Could not load the royaume template\");\n        setShowError(true);\n        return;\n      }\n      const templateArrayBuffer = await templateResponse.arrayBuffer();\n\n      // Initialize docxtemplater\n      const zip = new PizZip(templateArrayBuffer);\n      const doc = new Docxtemplater(zip, {\n        paragraphLoop: true,\n        linebreaks: true\n      });\n\n      // ðŸ” Detect columns dynamically â€” with normalization\n      const titleCol = Object.keys(data[0]).find(col => normalizeString(col).includes(\"designation\")) || \"designation des ouvrages\";\n      const descCol = Object.keys(data[0]).find(col => normalizeString(col).includes(\"descriptif\")) || \"descriptif\";\n\n      // Prepare data\n      const projects = selected.map((row, indexId) => ({\n        id: indexId + 1,\n        title: row[titleCol] || \"Sans Titre\",\n        descriptif: row[descCol] || \"\"\n      }));\n      //.filter((project) => project.descriptif.trim() !== \"\"); // â† Skip if empty or only whitespace\n      // Inject data\n      doc.setData({\n        projects\n      });\n\n      // Render\n      doc.render();\n\n      // Generate and save\n      const blob = doc.getZip().generate({\n        type: \"blob\",\n        mimeType: \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\"\n      });\n      const wordFileName = fileName ? `descriptions_${fileName.replace(/\\.[^/.]+$/, \"\")}.docx` : \"project_descriptions.docx\";\n      const success = await saveFile(await blob.arrayBuffer(), wordFileName, \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\");\n      if (!success) {\n        setErrorMessage(\"Export canceled by user.\");\n        setShowError(true);\n        return;\n      }\n      alert(`âœ… Word document exported successfully!`);\n    } catch (error) {\n      console.error(\"ðŸš¨ docxtemplater Error:\", error);\n      setErrorMessage(`Export failed: ${error.message || \"Unknown error\"}`);\n      setShowError(true);\n    }\n  };\n\n  // where the app begins\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"app-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"header-section\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        className: \"header-title\",\n        children: \"\\uD83D\\uDCCA Project Data Selector & Exporter\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 444,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"header-subtitle\",\n        children: \"Import your Excel file, select the projects you want, and export clean data or rich descriptions \\u2014 all in a few clicks.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 445,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 443,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"import-button-wrapper\",\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleFileImport,\n        className: \"import-button\",\n        children: \"\\uD83D\\uDCC1 Import Excel File\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 453,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 452,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      className: \"hidden\",\n      ref: fileInputRef,\n      type: \"file\",\n      accept: \".xlsx,.xls,.csv\",\n      onChange: handleFileChange\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 458,\n      columnNumber: 7\n    }, this), showError && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"error-modal-overlay\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"error-modal\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"error-modal-header\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"error-icon\",\n            children: /*#__PURE__*/_jsxDEV(\"svg\", {\n              className: \"error-svg\",\n              fill: \"none\",\n              stroke: \"currentColor\",\n              viewBox: \"0 0 24 24\",\n              children: /*#__PURE__*/_jsxDEV(\"path\", {\n                strokeLinecap: \"round\",\n                strokeLinejoin: \"round\",\n                strokeWidth: \"2\",\n                d: \"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 13.5c-.77.833.192 2.5 1.732 2.5z\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 478,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 472,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 471,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              className: \"error-title\",\n              children: \"Oops!\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 487,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"error-message\",\n              children: errorMessage\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 488,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 486,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 470,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: closeError,\n          className: \"error-close-button\",\n          children: \"Close\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 491,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 469,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 468,\n      columnNumber: 9\n    }, this), fileName && data.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"file-info-section\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"file-summary-card\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"file-summary-title\",\n          children: \"\\u2705 File Imported Successfully\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 503,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"file-stats-grid\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"stat-card\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"stat-label\",\n              children: \"File Name\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 508,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"stat-value\",\n              children: fileName\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 509,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 507,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"stat-card\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"stat-label\",\n              children: \"Total Rows\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 512,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"stat-value\",\n              children: data.length\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 513,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 511,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"stat-card\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"stat-label\",\n              children: \"Columns\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 516,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"stat-value\",\n              children: Object.keys(data[0]).length\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 517,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 515,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 506,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 502,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"projects-table-container\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"table-header\",\n          children: /*#__PURE__*/_jsxDEV(\"h4\", {\n            className: \"table-title\",\n            children: [\"\\uD83D\\uDCCB All Projects (\", data.length, \")\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 527,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 526,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"table-wrapper\",\n          children: /*#__PURE__*/_jsxDEV(\"table\", {\n            className: \"projects-table\",\n            children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n              children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"table-head-cell\",\n                  children: \"Select\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 533,\n                  columnNumber: 21\n                }, this), Object.keys(data[0]).map(key => {\n                  let displayName = key;\n                  if (normalizeString(key).includes(\"nÂ° prix\")) displayName = \"Code\";else if (normalizeString(key).includes(\"designation\")) displayName = \"DÃ©signation\";else if (normalizeString(key).includes(\"unite\")) displayName = \"UnitÃ©\";else if (normalizeString(key).includes(\"quantit\")) displayName = \"QtÃ©\";else if (normalizeString(key).includes(\"p.u\")) displayName = \"P.U HT\";else if (normalizeString(key).includes(\"motant\")) displayName = \"Total HT\";else if (normalizeString(key).includes(\"description\")) displayName = \"Description (longue)\";\n                  return /*#__PURE__*/_jsxDEV(\"th\", {\n                    className: `table-head-cell ${normalizeString(key).includes(\"description\") ? \"description-column\" : \"\"}`,\n                    children: displayName\n                  }, key, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 552,\n                    columnNumber: 25\n                  }, this);\n                })]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 532,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 531,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n              children: data.map((row, index) => {\n                const keys = Object.keys(row);\n                return /*#__PURE__*/_jsxDEV(\"tr\", {\n                  className: \"table-row\",\n                  children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"table-cell\",\n                    children: /*#__PURE__*/_jsxDEV(\"input\", {\n                      type: \"checkbox\",\n                      checked: selectedRows.has(index),\n                      onChange: () => toggleRowSelection(index),\n                      className: \"select-checkbox\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 573,\n                      columnNumber: 27\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 572,\n                    columnNumber: 25\n                  }, this), Object.values(row).map((value, cellIndex) => {\n                    const key = keys[cellIndex];\n                    let displayValue = String(value);\n                    if (normalizeString(key).includes(\"description\") && displayValue.length > 50) {\n                      displayValue = displayValue.substring(0, 50) + \"...\";\n                    }\n                    return /*#__PURE__*/_jsxDEV(\"td\", {\n                      className: \"table-cell\",\n                      title: String(value),\n                      children: displayValue\n                    }, cellIndex, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 593,\n                      columnNumber: 29\n                    }, this);\n                  })]\n                }, index, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 571,\n                  columnNumber: 23\n                }, this);\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 567,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 530,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 529,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 525,\n        columnNumber: 11\n      }, this), selectedRows.size > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"selected-projects-container\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"table-header\",\n          children: /*#__PURE__*/_jsxDEV(\"h4\", {\n            className: \"table-title\",\n            children: [\"\\u2705 Selected Projects (\", selectedRows.size, \")\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 614,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 613,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"table-wrapper\",\n          children: /*#__PURE__*/_jsxDEV(\"table\", {\n            className: \"projects-table\",\n            children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n              children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"table-head-cell\",\n                  children: \"Id\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 622,\n                  columnNumber: 23\n                }, this), Object.keys(data[0]).filter(col => !normalizeString(col).includes(\"description\") && normalizeString(col) !== \"id\").map(key => /*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"table-head-cell\",\n                  children: key\n                }, key, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 630,\n                  columnNumber: 27\n                }, this))]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 621,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 620,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n              children: getSelectedData().map((row, index) => /*#__PURE__*/_jsxDEV(\"tr\", {\n                className: \"table-row\",\n                children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"table-cell\",\n                  children: index + 1\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 639,\n                  columnNumber: 25\n                }, this), Object.entries(row).map(([key, value]) => {\n                  if (normalizeString(key) === \"id\" || normalizeString(key).includes(\"description\")) return null;\n                  return /*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"table-cell\",\n                    children: String(value)\n                  }, key, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 647,\n                    columnNumber: 29\n                  }, this);\n                })]\n              }, index, true, {\n                fileName: _jsxFileName,\n                lineNumber: 638,\n                columnNumber: 23\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 636,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 619,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 618,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 612,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"export-section\",\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          className: \"export-title\",\n          children: \"\\uD83D\\uDCE4 Export Options\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 662,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"export-cards-grid\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"export-card excel-card\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"export-card-header\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"export-icon\",\n                children: \"\\uD83D\\uDCCA\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 667,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"h5\", {\n                className: \"export-card-title\",\n                children: \"Export Clean Excel\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 668,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 666,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"export-card-description\",\n              children: \"Exports selected rows without the description column \\u2014 perfect for data processing or sharing.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 670,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: exportExcelFile,\n              className: \"export-button excel-button\",\n              children: \"\\uD83D\\uDCCA Export Excel\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 674,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 665,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"export-card word-card\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"export-card-header\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"export-icon\",\n                children: \"\\uD83D\\uDCDD\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 685,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"h5\", {\n                className: \"export-card-title\",\n                children: \"Export Descriptions to Word\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 686,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 684,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"export-card-description\",\n              children: \"Exports project IDs, titles, and full descriptions in a beautifully formatted Word document.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 690,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: exportWordFile,\n              className: \"export-button word-button\",\n              children: \"\\uD83D\\uDCDD Export Word\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 694,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 683,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 663,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 661,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 500,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 441,\n    columnNumber: 5\n  }, this);\n};\n_s(ExcelWordExporter, \"DrqUQpx5xRmLnhtEmYZC9NoJjX0=\");\n_c = ExcelWordExporter;\nexport default ExcelWordExporter;\nvar _c;\n$RefreshReg$(_c, \"ExcelWordExporter\");","map":{"version":3,"names":["React","useState","useRef","XLSX","saveAs","PizZip","Docxtemplater","jsxDEV","_jsxDEV","isTauri","window","__TAURI__","saveFile","blob","fileName","save","writeBinaryFile","filePath","defaultPath","filters","name","extensions","arrayBuffer","Array","from","Uint8Array","error","console","normalizeString","str","normalize","replace","toLowerCase","trim","ExcelWordExporter","_s","data","setData","selectedRows","setSelectedRows","Set","setFileName","showError","setShowError","errorMessage","setErrorMessage","fileInputRef","handleFileImport","_fileInputRef$current","current","click","handleFileChange","event","file","target","files","validExtensions","fileExtension","slice","lastIndexOf","includes","value","reader","FileReader","onload","e","result","workbook","read","type","firstSheetName","SheetNames","worksheet","Sheets","range","utils","decode_range","raw_data","R","s","r","row","C","c","cell_address","cell_ref","encode_cell","cell","push","w","v","headerRowIndex","i","length","isArray","some","Error","headers","dataRows","jsonData","filter","map","obj","forEach","header","index","key","Object","values","val","String","message","readAsArrayBuffer","closeError","toggleRowSelection","newSelected","has","delete","add","getSelectedData","_","headerStyle","fill","fgColor","rgb","font","color","bold","sz","alignment","horizontal","vertical","wrapText","border","top","style","bottom","left","right","cellStyle","numberStyle","numFmt","exportExcelFile","selected","parseNumber","num","parseFloat","isNaN","nPrixCol","keys","find","col","titleCol","unitCol","qtyCol","priceCol","totalCol","excelData","qty","price","totalFromSource","DÃ©signation","UnitÃ©","QuantitÃ©","ws","json_to_sheet","skipHeader","columns","wch","colIndex","cellAddress","rowIndex","t","Number","wb","book_new","book_append_sheet","exportFileName","excelBuffer","write","bookType","uint8Array","success","alert","exportWordFile","templateResponse","fetch","ok","templateArrayBuffer","zip","doc","paragraphLoop","linebreaks","descCol","projects","indexId","id","title","descriptif","render","getZip","generate","mimeType","wordFileName","className","children","_jsxFileName","lineNumber","columnNumber","onClick","ref","accept","onChange","stroke","viewBox","strokeLinecap","strokeLinejoin","strokeWidth","d","displayName","checked","cellIndex","displayValue","substring","size","entries","_c","$RefreshReg$"],"sources":["/home/ali/Desktop/applications/src/ExcelWordExporter.js"],"sourcesContent":["import React, { useState, useRef } from \"react\";\nimport * as XLSX from \"xlsx-js-style\";\nimport { saveAs } from \"file-saver\";\n\nimport PizZip from \"pizzip\";\nimport Docxtemplater from \"docxtemplater\";\n// dectects tauri app folder\nconst isTauri = () => {\n  return (\n    typeof window !== \"undefined\" &&\n    \"__TAURI__\" in window &&\n    typeof window.__TAURI__ !== \"undefined\"\n  );\n};\n// ðŸ‘‡ Universal file saver â€” works in browser AND Tauri\n  async function saveFile(blob, fileName) {\n  try {\n    if (isTauri()) {\n      const { save } = await import(\"@tauri-apps/api/dialog\");\n      const { writeBinaryFile } = await import(\"@tauri-apps/api/fs\");\n\n      const filePath = await save({\n        defaultPath: fileName,\n        filters: [{ name: \"Files\", extensions: [\"xlsx\", \"docx\"] }],\n      });\n\n      if (filePath) {\n        const arrayBuffer = await blob.arrayBuffer();\n        await writeBinaryFile(filePath, Array.from(new Uint8Array(arrayBuffer)));\n      }\n    } else {\n      // ðŸŒ Browser â†’ trigger \"Save As\" with FileSaver\n      const { saveAs } = await import(\"file-saver\");\n      saveAs(blob, fileName);\n    }\n  } catch (error) {\n    console.error(\"Save failed:\", error);\n  }\n}\n\n// ðŸ‘‡ Helper function to normalize strings (remove accents, lowercase, clean spaces)\nconst normalizeString = (str) => {\n  if (typeof str !== \"string\") return \"\";\n  return str\n    .normalize(\"NFD\") // Split accented characters\n    .replace(/[\\u0300-\\u036f]/g, \"\") // Remove diacritics\n    .toLowerCase()\n    .trim()\n    .replace(/\\s+/g, \" \"); // Collapse spaces\n};\n\nconst ExcelWordExporter = () => {\n  const [data, setData] = useState([]);\n  const [selectedRows, setSelectedRows] = useState(new Set());\n  const [fileName, setFileName] = useState(\"\");\n  const [showError, setShowError] = useState(false);\n  const [errorMessage, setErrorMessage] = useState(\"\");\n  const fileInputRef = useRef(null);\n\n  // Handle file import\n  const handleFileImport = () => {\n    fileInputRef.current?.click();\n  };\n\n  // Handles any given extra column at the beginning so we can find the first column index:\n  // NÂ° PRIX\n  const handleFileChange = (event) => {\n    const file = event.target.files[0];\n    if (!file) return;\n\n    const validExtensions = [\".xlsx\", \".xls\", \".csv\"];\n    const fileExtension = file.name\n      .toLowerCase()\n      .slice(file.name.lastIndexOf(\".\"));\n\n    if (!validExtensions.includes(fileExtension)) {\n      setErrorMessage(\n        `Invalid file type. Please select an Excel file (.xlsx, .xls, or .csv). You selected: ${fileExtension}`\n      );\n      setShowError(true);\n      event.target.value = \"\";\n      return;\n    }\n\n    const reader = new FileReader();\n    reader.onload = (e) => {\n      try {\n        const data = new Uint8Array(e.target.result);\n        const workbook = XLSX.read(data, { type: \"array\" });\n        const firstSheetName = workbook.SheetNames[0];\n        const worksheet = workbook.Sheets[firstSheetName];\n\n        // âœ… Read sheet as 2D array â€” with empty string fallback\n        const range = XLSX.utils.decode_range(worksheet[\"!ref\"]);\n        const raw_data = [];\n        for (let R = range.s.r; R <= range.e.r; ++R) {\n          const row = [];\n          for (let C = range.s.c; C <= range.e.c; ++C) {\n            const cell_address = { c: C, r: R };\n            const cell_ref = XLSX.utils.encode_cell(cell_address);\n            const cell = worksheet[cell_ref];\n            row.push(cell ? cell.w || cell.v : \"\"); // â† Use formatted (w) or raw (v) value\n          }\n          raw_data.push(row);\n        }\n\n        // âœ… Find header row â€” look for \"NÂ° PRIX\"\n        let headerRowIndex = -1;\n        for (let i = 0; i < raw_data.length; i++) {\n          const row = raw_data[i];\n          if (\n            Array.isArray(row) &&\n            row.some(\n              (cell) =>\n                typeof cell === \"string\" &&\n                normalizeString(cell).includes(\"nÂ° prix\")\n            )\n          ) {\n            headerRowIndex = i;\n            break;\n          }\n        }\n\n        if (headerRowIndex === -1) {\n          throw new Error(\n            \"Could not detect header row. Please make sure 'NÂ° PRIX' column exists.\"\n          );\n        }\n\n        // âœ… Extract headers and data rows\n        const headers = raw_data[headerRowIndex];\n        const dataRows = raw_data.slice(headerRowIndex + 1);\n\n        // âœ… Convert to array of objects â€” with normalized keys\n        const jsonData = dataRows\n          .filter((row) => row && row.length > 0)\n          .map((row) => {\n            const obj = {};\n            headers.forEach((header, index) => {\n              const key = normalizeString(header || `col_${index}`);\n              obj[key] = index < row.length ? row[index] : \"\";\n            });\n            return obj;\n          })\n          .filter((obj) =>\n            Object.values(obj).some((val) => String(val).trim() !== \"\")\n          );\n\n        if (jsonData.length === 0) {\n          throw new Error(\"No valid data found after header row.\");\n        }\n\n        setData(jsonData);\n        setFileName(file.name);\n        setShowError(false);\n      } catch (error) {\n        console.error(\"File Read Error:\", error);\n        setErrorMessage(\n          error.message || \"Error reading Excel file. Please check format.\"\n        );\n        setShowError(true);\n      }\n    };\n    reader.readAsArrayBuffer(file);\n  };\n\n  const closeError = () => {\n    setShowError(false);\n    setErrorMessage(\"\");\n  };\n\n  // Toggle row selection\n  const toggleRowSelection = (index) => {\n    const newSelected = new Set(selectedRows);\n    if (newSelected.has(index)) {\n      newSelected.delete(index);\n    } else {\n      newSelected.add(index);\n    }\n    setSelectedRows(newSelected);\n  };\n\n  // Get selected data\n  const getSelectedData = () => {\n    return data.filter((_, index) => selectedRows.has(index));\n  };\n\n  // ðŸŽ¨ Excel Styles\n  const headerStyle = {\n    fill: { fgColor: { rgb: \"43A047\" } }, // Dark blue\n    font: { color: { rgb: \"000000\" }, bold: true, sz: 15 },\n    alignment: { horizontal: \"center\", vertical: \"center\", wrapText: true },\n    border: {\n      top: { style: \"thin\", color: { rgb: \"000000\" } },\n      bottom: { style: \"thin\", color: { rgb: \"000000\" } },\n      left: { style: \"thin\", color: { rgb: \"000000\" } },\n      right: { style: \"thin\", color: { rgb: \"000000\" } },\n    },\n  };\n\n  const cellStyle = {\n    alignment: { horizontal: \"left\", vertical: \"top\", wrapText: true },\n    border: {\n      top: { style: \"thin\", color: { rgb: \"D9D9D9\" } },\n      bottom: { style: \"thin\", color: { rgb: \"D9D9D9\" } },\n      left: { style: \"thin\", color: { rgb: \"D9D9D9\" } },\n      right: { style: \"thin\", color: { rgb: \"D9D9D9\" } },\n    },\n    font: { sz: 11 },\n  };\n\n  const numberStyle = {\n    ...cellStyle,\n    alignment: { horizontal: \"right\", vertical: \"top\" },\n    numFmt: \"#,##0.00\",\n  };\n\n  // Export Excel (without description) â€” with sequential ID reset + STYLING\n  const exportExcelFile = async () => {\n    const selected = getSelectedData();\n    if (selected.length === 0) {\n      setErrorMessage(\"No rows selected. Please select at least one row.\");\n      setShowError(true);\n      return;\n    }\n\n    try {\n      // Detect columns dynamically â€” using normalized search\n      const parseNumber = (value) => {\n        const num = parseFloat(value);\n        return !isNaN(num) ? num : 0;\n      };\n      const nPrixCol =\n        Object.keys(data[0]).find((col) =>\n          normalizeString(col).includes(\"nÂ° prix\")\n        ) || normalizeString(\"NÂ° Prix\");\n      const titleCol =\n        Object.keys(data[0]).find((col) =>\n          normalizeString(col).includes(\"designation\")\n        ) || normalizeString(\"designation des ouvrages\");\n      const unitCol =\n        Object.keys(data[0]).find((col) =>\n          normalizeString(col).includes(\"unite\")\n        ) || normalizeString(\"unite\");\n      const qtyCol =\n        Object.keys(data[0]).find((col) =>\n          normalizeString(col).includes(\"quantite\")\n        ) || normalizeString(\"quantites\");\n      const priceCol =\n        Object.keys(data[0]).find((col) =>\n          normalizeString(col).includes(\"p.u\")\n        ) || normalizeString(\"p.u dh.ht\");\n      const totalCol =\n        Object.keys(data[0]).find((col) =>\n          normalizeString(col).includes(\"montant total h.t\")\n        ) || normalizeString(\"Montant total H.T\");\n\n      // Prepare data\n      const excelData = selected.map((row) => {\n        const qty = parseNumber(row[qtyCol]);\n        const price = parseNumber(row[priceCol]);\n        const totalFromSource = parseNumber(row[totalCol]);\n\n        return {\n          \"NÂ°Prix\": row[nPrixCol] || \"\", // â† PRESERVE ORIGINAL VALUE (A, a, 1, 2, B, etc.)\n          DÃ©signation: row[titleCol] || \"Sans Titre\",\n          UnitÃ©: row[unitCol] || \"\",\n          QuantitÃ©: qty,\n          \"P.U DH.HT\": price,\n          \"Montant Total HT\": totalFromSource || qty * price,\n        };\n      });\n\n      // Create worksheet\n      const ws = XLSX.utils.json_to_sheet(excelData, { skipHeader: true });\n\n      // Define columns\n      const headers = [\n        \"NÂ°Prix\",\n        \"DÃ©signation\",\n        \"UnitÃ©\",\n        \"QuantitÃ©\",\n        \"P.U DH.HT\",\n        \"Montant Total HT\",\n      ];\n\n      const columns = [\n        { wch: 8 }, // NÂ°Prix\n        { wch: 40 }, // DÃ©signation\n        { wch: 10 }, // UnitÃ©\n        { wch: 12 }, // QuantitÃ©\n        { wch: 15 }, // P.U DH.HT\n        { wch: 18 }, // Montant Total HT\n      ];\n      ws[\"!cols\"] = columns;\n\n      // Add styled headers\n      headers.forEach((header, colIndex) => {\n        const cellAddress = XLSX.utils.encode_cell({ r: 0, c: colIndex });\n        ws[cellAddress] = { v: header, s: headerStyle };\n      });\n\n      // Style data cells\n      for (let rowIndex = 1; rowIndex <= excelData.length; rowIndex++) {\n        for (let colIndex = 0; colIndex < headers.length; colIndex++) {\n          const cellAddress = XLSX.utils.encode_cell({\n            r: rowIndex,\n            c: colIndex,\n          });\n          if (!ws[cellAddress]) continue;\n\n          if ([3, 4, 5].includes(colIndex)) {\n            // Numeric columns\n            ws[cellAddress].s = numberStyle;\n            ws[cellAddress].t = \"n\";\n            ws[cellAddress].v = Number(ws[cellAddress].v);\n          } else {\n            ws[cellAddress].s = cellStyle;\n          }\n        }\n      }\n\n      // Finalize and export\n      const wb = XLSX.utils.book_new();\n      XLSX.utils.book_append_sheet(wb, ws, \"Selected Projects\");\n\n      const exportFileName = fileName\n        ? `export_${fileName.replace(/\\.[^/.]+$/, \"\")}.xlsx`\n        : \"project_export.xlsx\";\n\n      // âœ… START REPLACEMENT â€” Replace XLSX.writeFile with this block\n      // âœ… Generate buffer (same as before)\n      const excelBuffer = XLSX.write(wb, { bookType: \"xlsx\", type: \"array\" });\n      const uint8Array = new Uint8Array(excelBuffer);\n\n      // âœ… Use universal saver\n      const success = await saveFile(\n        uint8Array,\n        exportFileName,\n        \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"\n      );\n\n      if (!success) {\n        setErrorMessage(\"Export canceled by user.\");\n        setShowError(true);\n        return;\n      }\n\n      alert(`âœ… Excel exported successfully!`);\n\n      // âœ… END REPLACEMENT\n    } catch (error) {\n      console.error(\"Export Excel Error:\", error);\n      setErrorMessage(\"Error exporting Excel file.\");\n      setShowError(true);\n    }\n  };\n\n  // Export Word (with description) â€” FIXED\n  const exportWordFile = async () => {\n    const selected = getSelectedData();\n    if (selected.length === 0) {\n      setErrorMessage(\"No rows selected. Please select at least one row.\");\n      setShowError(true);\n      return;\n    }\n\n    try {\n      // Load the official template\n      const templateResponse = await fetch(\"/templates/ROYAUME_DU_MAROC.docx\");\n      if (!templateResponse.ok) {\n        setErrorMessage(\"Could not load the royaume template\");\n        setShowError(true);\n        return;\n      }\n      const templateArrayBuffer = await templateResponse.arrayBuffer();\n\n      // Initialize docxtemplater\n      const zip = new PizZip(templateArrayBuffer);\n      const doc = new Docxtemplater(zip, {\n        paragraphLoop: true,\n        linebreaks: true,\n      });\n\n      // ðŸ” Detect columns dynamically â€” with normalization\n      const titleCol =\n        Object.keys(data[0]).find((col) =>\n          normalizeString(col).includes(\"designation\")\n        ) || \"designation des ouvrages\";\n\n      const descCol =\n        Object.keys(data[0]).find((col) =>\n          normalizeString(col).includes(\"descriptif\")\n        ) || \"descriptif\";\n\n      // Prepare data\n      const projects = selected.map((row, indexId) => ({\n        id: indexId + 1,\n        title: row[titleCol] || \"Sans Titre\",\n        descriptif: row[descCol] || \"\",\n      }));\n      //.filter((project) => project.descriptif.trim() !== \"\"); // â† Skip if empty or only whitespace\n      // Inject data\n      doc.setData({ projects });\n\n      // Render\n      doc.render();\n\n      // Generate and save\n      const blob = doc.getZip().generate({\n        type: \"blob\",\n        mimeType:\n          \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\",\n      });\n      const wordFileName = fileName\n        ? `descriptions_${fileName.replace(/\\.[^/.]+$/, \"\")}.docx`\n        : \"project_descriptions.docx\";\n\n      const success = await saveFile(\n        await blob.arrayBuffer(),\n        wordFileName,\n        \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\"\n      );\n\n      if (!success) {\n        setErrorMessage(\"Export canceled by user.\");\n        setShowError(true);\n        return;\n      }\n\n      alert(`âœ… Word document exported successfully!`);\n    } catch (error) {\n      console.error(\"ðŸš¨ docxtemplater Error:\", error);\n      setErrorMessage(`Export failed: ${error.message || \"Unknown error\"}`);\n      setShowError(true);\n    }\n  };\n\n  // where the app begins\n  return (\n    <div className=\"app-container\">\n      {/* Header Section */}\n      <div className=\"header-section\">\n        <h1 className=\"header-title\">ðŸ“Š Project Data Selector & Exporter</h1>\n        <p className=\"header-subtitle\">\n          Import your Excel file, select the projects you want, and export clean\n          data or rich descriptions â€” all in a few clicks.\n        </p>\n      </div>\n\n      {/* Import Button */}\n      <div className=\"import-button-wrapper\">\n        <button onClick={handleFileImport} className=\"import-button\">\n          ðŸ“ Import Excel File\n        </button>\n      </div>\n\n      <input\n        className=\"hidden\"\n        ref={fileInputRef}\n        type=\"file\"\n        accept=\".xlsx,.xls,.csv\"\n        onChange={handleFileChange}\n      />\n\n      {/* Error Modal */}\n      {showError && (\n        <div className=\"error-modal-overlay\">\n          <div className=\"error-modal\">\n            <div className=\"error-modal-header\">\n              <div className=\"error-icon\">\n                <svg\n                  className=\"error-svg\"\n                  fill=\"none\"\n                  stroke=\"currentColor\"\n                  viewBox=\"0 0 24 24\"\n                >\n                  <path\n                    strokeLinecap=\"round\"\n                    strokeLinejoin=\"round\"\n                    strokeWidth=\"2\"\n                    d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 13.5c-.77.833.192 2.5 1.732 2.5z\"\n                  />\n                </svg>\n              </div>\n              <div>\n                <h3 className=\"error-title\">Oops!</h3>\n                <p className=\"error-message\">{errorMessage}</p>\n              </div>\n            </div>\n            <button onClick={closeError} className=\"error-close-button\">\n              Close\n            </button>\n          </div>\n        </div>\n      )}\n\n      {/* File Info & Data Table */}\n      {fileName && data.length > 0 && (\n        <div className=\"file-info-section\">\n          {/* File Summary Card */}\n          <div className=\"file-summary-card\">\n            <h3 className=\"file-summary-title\">\n              âœ… File Imported Successfully\n            </h3>\n            <div className=\"file-stats-grid\">\n              <div className=\"stat-card\">\n                <span className=\"stat-label\">File Name</span>\n                <span className=\"stat-value\">{fileName}</span>\n              </div>\n              <div className=\"stat-card\">\n                <span className=\"stat-label\">Total Rows</span>\n                <span className=\"stat-value\">{data.length}</span>\n              </div>\n              <div className=\"stat-card\">\n                <span className=\"stat-label\">Columns</span>\n                <span className=\"stat-value\">\n                  {Object.keys(data[0]).length}\n                </span>\n              </div>\n            </div>\n          </div>\n\n          {/* Full Projects Table */}\n          <div className=\"projects-table-container\">\n            <div className=\"table-header\">\n              <h4 className=\"table-title\">ðŸ“‹ All Projects ({data.length})</h4>\n            </div>\n            <div className=\"table-wrapper\">\n              <table className=\"projects-table\">\n                <thead>\n                  <tr>\n                    <th className=\"table-head-cell\">Select</th>\n                    {Object.keys(data[0]).map((key) => {\n                      let displayName = key;\n                      if (normalizeString(key).includes(\"nÂ° prix\"))\n                        displayName = \"Code\";\n                      else if (normalizeString(key).includes(\"designation\"))\n                        displayName = \"DÃ©signation\";\n                      else if (normalizeString(key).includes(\"unite\"))\n                        displayName = \"UnitÃ©\";\n                      else if (normalizeString(key).includes(\"quantit\"))\n                        displayName = \"QtÃ©\";\n                      else if (normalizeString(key).includes(\"p.u\"))\n                        displayName = \"P.U HT\";\n                      else if (normalizeString(key).includes(\"motant\"))\n                        displayName = \"Total HT\";\n                      else if (normalizeString(key).includes(\"description\"))\n                        displayName = \"Description (longue)\";\n\n                      return (\n                        <th\n                          key={key}\n                          className={`table-head-cell ${\n                            normalizeString(key).includes(\"description\")\n                              ? \"description-column\"\n                              : \"\"\n                          }`}\n                        >\n                          {displayName}\n                        </th>\n                      );\n                    })}\n                  </tr>\n                </thead>\n\n                <tbody>\n                  {data.map((row, index) => {\n                    const keys = Object.keys(row);\n                    return (\n                      <tr key={index} className=\"table-row\">\n                        <td className=\"table-cell\">\n                          <input\n                            type=\"checkbox\"\n                            checked={selectedRows.has(index)}\n                            onChange={() => toggleRowSelection(index)}\n                            className=\"select-checkbox\"\n                          />\n                        </td>\n                        {Object.values(row).map((value, cellIndex) => {\n                          const key = keys[cellIndex];\n                          let displayValue = String(value);\n\n                          if (\n                            normalizeString(key).includes(\"description\") &&\n                            displayValue.length > 50\n                          ) {\n                            displayValue =\n                              displayValue.substring(0, 50) + \"...\";\n                          }\n\n                          return (\n                            <td\n                              key={cellIndex}\n                              className=\"table-cell\"\n                              title={String(value)}\n                            >\n                              {displayValue}\n                            </td>\n                          );\n                        })}\n                      </tr>\n                    );\n                  })}\n                </tbody>\n              </table>\n            </div>\n          </div>\n\n          {/* Selected Projects Preview */}\n          {selectedRows.size > 0 && (\n            <div className=\"selected-projects-container\">\n              <div className=\"table-header\">\n                <h4 className=\"table-title\">\n                  âœ… Selected Projects ({selectedRows.size})\n                </h4>\n              </div>\n              <div className=\"table-wrapper\">\n                <table className=\"projects-table\">\n                  <thead>\n                    <tr>\n                      <th className=\"table-head-cell\">Id</th>\n                      {Object.keys(data[0])\n                        .filter(\n                          (col) =>\n                            !normalizeString(col).includes(\"description\") &&\n                            normalizeString(col) !== \"id\"\n                        )\n                        .map((key) => (\n                          <th key={key} className=\"table-head-cell\">\n                            {key}\n                          </th>\n                        ))}\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {getSelectedData().map((row, index) => (\n                      <tr key={index} className=\"table-row\">\n                        <td className=\"table-cell\">{index + 1}</td>\n                        {Object.entries(row).map(([key, value]) => {\n                          if (\n                            normalizeString(key) === \"id\" ||\n                            normalizeString(key).includes(\"description\")\n                          )\n                            return null;\n                          return (\n                            <td key={key} className=\"table-cell\">\n                              {String(value)}\n                            </td>\n                          );\n                        })}\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n            </div>\n          )}\n\n          {/* Export Options */}\n          <div className=\"export-section\">\n            <h4 className=\"export-title\">ðŸ“¤ Export Options</h4>\n            <div className=\"export-cards-grid\">\n              {/* Excel Export Card */}\n              <div className=\"export-card excel-card\">\n                <div className=\"export-card-header\">\n                  <div className=\"export-icon\">ðŸ“Š</div>\n                  <h5 className=\"export-card-title\">Export Clean Excel</h5>\n                </div>\n                <p className=\"export-card-description\">\n                  Exports selected rows without the description column â€” perfect\n                  for data processing or sharing.\n                </p>\n                <button\n                  onClick={exportExcelFile}\n                  className=\"export-button excel-button\"\n                >\n                  ðŸ“Š Export Excel\n                </button>\n              </div>\n\n              {/* Word Export Card */}\n              <div className=\"export-card word-card\">\n                <div className=\"export-card-header\">\n                  <div className=\"export-icon\">ðŸ“</div>\n                  <h5 className=\"export-card-title\">\n                    Export Descriptions to Word\n                  </h5>\n                </div>\n                <p className=\"export-card-description\">\n                  Exports project IDs, titles, and full descriptions in a\n                  beautifully formatted Word document.\n                </p>\n                <button\n                  onClick={exportWordFile}\n                  className=\"export-button word-button\"\n                >\n                  ðŸ“ Export Word\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default ExcelWordExporter;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}