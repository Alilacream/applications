{"ast":null,"code":"var _jsxFileName = \"/home/ali/Desktop/applications/src/ExcelWordExporter.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef } from \"react\";\nimport * as XLSX from \"xlsx-js-style\";\nimport PizZip from \"pizzip\";\nimport Docxtemplater from \"docxtemplater\";\n// dectects tauri app folder\nimport { save } from \"@tauri-apps/api/dialog\";\nimport { writeBinaryFile } from \"@tauri-apps/api/fs\";\nimport { open } from \"@tauri-apps/api/shell\";\nimport { dirname } from \"@tauri-apps/api/path\";\nimport { saveAs } from \"file-saver\"; // 👈 already imported in your original code\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst isTauri = () => {\n  return typeof window !== \"undefined\" && \"__TAURI__\" in window && typeof window.__TAURI__ !== \"undefined\";\n};\n// 👇 Universal file saver — works in browser AND Tauri\n// ✅ MOVE THESE TO THE TOP OF YOUR FILE (STATIC IMPORTS)\n// ✅ NEW & IMPROVED saveFile FUNCTION\nasync function saveFile(blob, fileName) {\n  try {\n    if (isTauri()) {\n      console.log(\"🚀 Tauri detected — opening save dialog...\");\n\n      // 👇 SHOW NATIVE SAVE DIALOG\n      const filePath = await save({\n        title: \"Save File\",\n        // 👈 optional but user-friendly\n        defaultPath: fileName,\n        filters: [{\n          name: fileName.endsWith(\".xlsx\") ? \"Excel File\" : \"Word Document\",\n          extensions: [fileName.split(\".\").pop()] // 👈 dynamic based on file\n        }]\n      });\n\n      // 👇 USER CANCELED\n      if (!filePath) {\n        console.log(\"❌ User canceled save dialog\");\n        alert(\"Export canceled — no file was saved.\");\n        return;\n      }\n      console.log(`✅ Saving to: ${filePath}`);\n\n      // 👇 CONVERT BLOB → ARRAYBUFFER → UINT8ARRAY (no Array.from needed)\n      const arrayBuffer = await blob.arrayBuffer();\n      const uint8Array = new Uint8Array(arrayBuffer);\n\n      // 👇 WRITE FILE\n      await writeBinaryFile(filePath, uint8Array);\n\n      // 👇 OPTIONAL: OPEN FOLDER AFTER SAVING\n      const folderPath = await dirname(filePath);\n      await open(folderPath);\n      alert(`✅ File saved successfully!\\n📁 ${filePath}`);\n    } else {\n      // 🌐 BROWSER FALLBACK\n      console.log(\"🌐 Browser detected — downloading file...\");\n      saveAs(blob, fileName);\n    }\n  } catch (error) {\n    console.error(\"🚨 Save failed:\", error);\n    alert(`Export failed: ${error.message || \"Unknown error\"}`);\n  }\n}\n\n// 👇 Helper function to normalize strings (remove accents, lowercase, clean spaces)\nconst normalizeString = str => {\n  if (typeof str !== \"string\") return \"\";\n  return str.normalize(\"NFD\") // Split accented characters\n  .replace(/[\\u0300-\\u036f]/g, \"\") // Remove diacritics\n  .toLowerCase().trim().replace(/\\s+/g, \" \"); // Collapse spaces\n};\nconst ExcelWordExporter = () => {\n  _s();\n  const [data, setData] = useState([]);\n  const [selectedRows, setSelectedRows] = useState(new Set());\n  const [fileName, setFileName] = useState(\"\");\n  const [showError, setShowError] = useState(false);\n  const [errorMessage, setErrorMessage] = useState(\"\");\n  const fileInputRef = useRef(null);\n\n  // Handle file import\n  const handleFileImport = () => {\n    var _fileInputRef$current;\n    (_fileInputRef$current = fileInputRef.current) === null || _fileInputRef$current === void 0 ? void 0 : _fileInputRef$current.click();\n  };\n\n  // Handles any given extra column at the beginning so we can find the first column index:\n  // N° PRIX\n  const handleFileChange = event => {\n    const file = event.target.files[0];\n    if (!file) return;\n    const validExtensions = [\".xlsx\", \".xls\", \".csv\"];\n    const fileExtension = file.name.toLowerCase().slice(file.name.lastIndexOf(\".\"));\n    if (!validExtensions.includes(fileExtension)) {\n      setErrorMessage(`Invalid file type. Please select an Excel file (.xlsx, .xls, or .csv). You selected: ${fileExtension}`);\n      setShowError(true);\n      event.target.value = \"\";\n      return;\n    }\n    const reader = new FileReader();\n    reader.onload = e => {\n      try {\n        const data = new Uint8Array(e.target.result);\n        const workbook = XLSX.read(data, {\n          type: \"array\"\n        });\n        const firstSheetName = workbook.SheetNames[0];\n        const worksheet = workbook.Sheets[firstSheetName];\n\n        // ✅ Read sheet as 2D array — with empty string fallback\n        const range = XLSX.utils.decode_range(worksheet[\"!ref\"]);\n        const raw_data = [];\n        for (let R = range.s.r; R <= range.e.r; ++R) {\n          const row = [];\n          for (let C = range.s.c; C <= range.e.c; ++C) {\n            const cell_address = {\n              c: C,\n              r: R\n            };\n            const cell_ref = XLSX.utils.encode_cell(cell_address);\n            const cell = worksheet[cell_ref];\n            row.push(cell ? cell.w || cell.v : \"\"); // ← Use formatted (w) or raw (v) value\n          }\n          raw_data.push(row);\n        }\n\n        // ✅ Find header row — look for \"N° PRIX\"\n        let headerRowIndex = -1;\n        for (let i = 0; i < raw_data.length; i++) {\n          const row = raw_data[i];\n          if (Array.isArray(row) && row.some(cell => typeof cell === \"string\" && normalizeString(cell).includes(\"n° prix\"))) {\n            headerRowIndex = i;\n            break;\n          }\n        }\n        if (headerRowIndex === -1) {\n          throw new Error(\"Could not detect header row. Please make sure 'N° PRIX' column exists.\");\n        }\n\n        // ✅ Extract headers and data rows\n        const headers = raw_data[headerRowIndex];\n        const dataRows = raw_data.slice(headerRowIndex + 1);\n\n        // ✅ Convert to array of objects — with normalized keys\n        const jsonData = dataRows.filter(row => row && row.length > 0).map(row => {\n          const obj = {};\n          headers.forEach((header, index) => {\n            const key = normalizeString(header || `col_${index}`);\n            obj[key] = index < row.length ? row[index] : \"\";\n          });\n          return obj;\n        }).filter(obj => Object.values(obj).some(val => String(val).trim() !== \"\"));\n        if (jsonData.length === 0) {\n          throw new Error(\"No valid data found after header row.\");\n        }\n        setData(jsonData);\n        setFileName(file.name);\n        setShowError(false);\n      } catch (error) {\n        console.error(\"File Read Error:\", error);\n        setErrorMessage(error.message || \"Error reading Excel file. Please check format.\");\n        setShowError(true);\n      }\n    };\n    reader.readAsArrayBuffer(file);\n  };\n  const closeError = () => {\n    setShowError(false);\n    setErrorMessage(\"\");\n  };\n\n  // Toggle row selection\n  const toggleRowSelection = index => {\n    const newSelected = new Set(selectedRows);\n    if (newSelected.has(index)) {\n      newSelected.delete(index);\n    } else {\n      newSelected.add(index);\n    }\n    setSelectedRows(newSelected);\n  };\n\n  // Get selected data\n  const getSelectedData = () => {\n    return data.filter((_, index) => selectedRows.has(index));\n  };\n\n  // 🎨 Excel Styles\n  const headerStyle = {\n    fill: {\n      fgColor: {\n        rgb: \"43A047\"\n      }\n    },\n    // Dark blue\n    font: {\n      color: {\n        rgb: \"000000\"\n      },\n      bold: true,\n      sz: 15\n    },\n    alignment: {\n      horizontal: \"center\",\n      vertical: \"center\",\n      wrapText: true\n    },\n    border: {\n      top: {\n        style: \"thin\",\n        color: {\n          rgb: \"000000\"\n        }\n      },\n      bottom: {\n        style: \"thin\",\n        color: {\n          rgb: \"000000\"\n        }\n      },\n      left: {\n        style: \"thin\",\n        color: {\n          rgb: \"000000\"\n        }\n      },\n      right: {\n        style: \"thin\",\n        color: {\n          rgb: \"000000\"\n        }\n      }\n    }\n  };\n  const cellStyle = {\n    alignment: {\n      horizontal: \"left\",\n      vertical: \"top\",\n      wrapText: true\n    },\n    border: {\n      top: {\n        style: \"thin\",\n        color: {\n          rgb: \"D9D9D9\"\n        }\n      },\n      bottom: {\n        style: \"thin\",\n        color: {\n          rgb: \"D9D9D9\"\n        }\n      },\n      left: {\n        style: \"thin\",\n        color: {\n          rgb: \"D9D9D9\"\n        }\n      },\n      right: {\n        style: \"thin\",\n        color: {\n          rgb: \"D9D9D9\"\n        }\n      }\n    },\n    font: {\n      sz: 11\n    }\n  };\n  const numberStyle = {\n    ...cellStyle,\n    alignment: {\n      horizontal: \"right\",\n      vertical: \"top\"\n    },\n    numFmt: \"#,##0.00\"\n  };\n\n  // Export Excel (without description) — with sequential ID reset + STYLING\n  const exportExcelFile = async () => {\n    const selected = getSelectedData();\n    if (selected.length === 0) {\n      setErrorMessage(\"No rows selected. Please select at least one row.\");\n      setShowError(true);\n      return;\n    }\n    try {\n      // Detect columns dynamically — using normalized search\n      const parseNumber = value => {\n        const num = parseFloat(value);\n        return !isNaN(num) ? num : 0;\n      };\n      const nPrixCol = Object.keys(data[0]).find(col => normalizeString(col).includes(\"n° prix\")) || normalizeString(\"N° Prix\");\n      const titleCol = Object.keys(data[0]).find(col => normalizeString(col).includes(\"designation\")) || normalizeString(\"designation des ouvrages\");\n      const unitCol = Object.keys(data[0]).find(col => normalizeString(col).includes(\"unite\")) || normalizeString(\"unite\");\n      const qtyCol = Object.keys(data[0]).find(col => normalizeString(col).includes(\"quantite\")) || normalizeString(\"quantites\");\n      const priceCol = Object.keys(data[0]).find(col => normalizeString(col).includes(\"p.u\")) || normalizeString(\"p.u dh.ht\");\n      const totalCol = Object.keys(data[0]).find(col => normalizeString(col).includes(\"montant total h.t\")) || normalizeString(\"Montant total H.T\");\n\n      // Prepare data\n      const excelData = selected.map(row => {\n        const qty = parseNumber(row[qtyCol]);\n        const price = parseNumber(row[priceCol]);\n        const totalFromSource = parseNumber(row[totalCol]);\n        return {\n          \"N°Prix\": row[nPrixCol] || \"\",\n          // ← PRESERVE ORIGINAL VALUE (A, a, 1, 2, B, etc.)\n          Désignation: row[titleCol] || \"Sans Titre\",\n          Unité: row[unitCol] || \"\",\n          Quantité: qty,\n          \"P.U DH.HT\": price,\n          \"Montant Total HT\": totalFromSource || qty * price\n        };\n      });\n\n      // Create worksheet\n      const ws = XLSX.utils.json_to_sheet(excelData, {\n        skipHeader: true\n      });\n\n      // Define columns\n      const headers = [\"N°Prix\", \"Désignation\", \"Unité\", \"Quantité\", \"P.U DH.HT\", \"Montant Total HT\"];\n      const columns = [{\n        wch: 8\n      },\n      // N°Prix\n      {\n        wch: 40\n      },\n      // Désignation\n      {\n        wch: 10\n      },\n      // Unité\n      {\n        wch: 12\n      },\n      // Quantité\n      {\n        wch: 15\n      },\n      // P.U DH.HT\n      {\n        wch: 18\n      } // Montant Total HT\n      ];\n      ws[\"!cols\"] = columns;\n\n      // Add styled headers\n      headers.forEach((header, colIndex) => {\n        const cellAddress = XLSX.utils.encode_cell({\n          r: 0,\n          c: colIndex\n        });\n        ws[cellAddress] = {\n          v: header,\n          s: headerStyle\n        };\n      });\n\n      // Style data cells\n      for (let rowIndex = 1; rowIndex <= excelData.length; rowIndex++) {\n        for (let colIndex = 0; colIndex < headers.length; colIndex++) {\n          const cellAddress = XLSX.utils.encode_cell({\n            r: rowIndex,\n            c: colIndex\n          });\n          if (!ws[cellAddress]) continue;\n          if ([3, 4, 5].includes(colIndex)) {\n            // Numeric columns\n            ws[cellAddress].s = numberStyle;\n            ws[cellAddress].t = \"n\";\n            ws[cellAddress].v = Number(ws[cellAddress].v);\n          } else {\n            ws[cellAddress].s = cellStyle;\n          }\n        }\n      }\n\n      // Finalize and export\n      const wb = XLSX.utils.book_new();\n      XLSX.utils.book_append_sheet(wb, ws, \"Selected Projects\");\n      const exportFileName = fileName ? `export_${fileName.replace(/\\.[^/.]+$/, \"\")}.xlsx` : \"project_export.xlsx\";\n\n      // ✅ START REPLACEMENT — Replace XLSX.writeFile with this block\n      // ✅ Generate buffer (same as before)\n      const excelBuffer = XLSX.write(wb, {\n        bookType: \"xlsx\",\n        type: \"array\"\n      });\n      const uint8Array = new Uint8Array(excelBuffer);\n\n      // ✅ Use universal saver\n      const success = await saveFile(uint8Array, exportFileName, \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\");\n      if (!success) {\n        setErrorMessage(\"Export canceled by user.\");\n        setShowError(true);\n        return;\n      }\n      alert(`✅ Excel exported successfully!`);\n\n      // ✅ END REPLACEMENT\n    } catch (error) {\n      console.error(\"Export Excel Error:\", error);\n      setErrorMessage(\"Error exporting Excel file.\");\n      setShowError(true);\n    }\n  };\n\n  // Export Word (with description) — FIXED\n  const exportWordFile = async () => {\n    const selected = getSelectedData();\n    if (selected.length === 0) {\n      setErrorMessage(\"No rows selected. Please select at least one row.\");\n      setShowError(true);\n      return;\n    }\n    try {\n      // Load the official template\n      const templateResponse = await fetch(\"/templates/ROYAUME_DU_MAROC.docx\");\n      if (!templateResponse.ok) {\n        setErrorMessage(\"Could not load the royaume template\");\n        setShowError(true);\n        return;\n      }\n      const templateArrayBuffer = await templateResponse.arrayBuffer();\n\n      // Initialize docxtemplater\n      const zip = new PizZip(templateArrayBuffer);\n      const doc = new Docxtemplater(zip, {\n        paragraphLoop: true,\n        linebreaks: true\n      });\n\n      // 🔍 Detect columns dynamically — with normalization\n      const titleCol = Object.keys(data[0]).find(col => normalizeString(col).includes(\"designation\")) || \"designation des ouvrages\";\n      const descCol = Object.keys(data[0]).find(col => normalizeString(col).includes(\"descriptif\")) || \"descriptif\";\n\n      // Prepare data\n      const projects = selected.map((row, indexId) => ({\n        id: indexId + 1,\n        title: row[titleCol] || \"Sans Titre\",\n        descriptif: row[descCol] || \"\"\n      }));\n      //.filter((project) => project.descriptif.trim() !== \"\"); // ← Skip if empty or only whitespace\n      // Inject data\n      doc.setData({\n        projects\n      });\n\n      // Render\n      doc.render();\n\n      // Generate and save\n      const blob = doc.getZip().generate({\n        type: \"blob\",\n        mimeType: \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\"\n      });\n      const wordFileName = fileName ? `descriptions_${fileName.replace(/\\.[^/.]+$/, \"\")}.docx` : \"project_descriptions.docx\";\n      const success = await saveFile(await blob.arrayBuffer(), wordFileName, \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\");\n      if (!success) {\n        setErrorMessage(\"Export canceled by user.\");\n        setShowError(true);\n        return;\n      }\n      alert(`✅ Word document exported successfully!`);\n    } catch (error) {\n      console.error(\"🚨 docxtemplater Error:\", error);\n      setErrorMessage(`Export failed: ${error.message || \"Unknown error\"}`);\n      setShowError(true);\n    }\n  };\n\n  // where the app begins\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"app-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"header-section\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        className: \"header-title\",\n        children: \"\\uD83D\\uDCCA Project Data Selector & Exporter\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 475,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"header-subtitle\",\n        children: \"Import your Excel file, select the projects you want, and export clean data or rich descriptions \\u2014 all in a few clicks.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 476,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 474,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"import-button-wrapper\",\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleFileImport,\n        className: \"import-button\",\n        children: \"\\uD83D\\uDCC1 Import Excel File\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 484,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 483,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      className: \"hidden\",\n      ref: fileInputRef,\n      type: \"file\",\n      accept: \".xlsx,.xls,.csv\",\n      onChange: handleFileChange\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 489,\n      columnNumber: 7\n    }, this), showError && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"error-modal-overlay\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"error-modal\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"error-modal-header\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"error-icon\",\n            children: /*#__PURE__*/_jsxDEV(\"svg\", {\n              className: \"error-svg\",\n              fill: \"none\",\n              stroke: \"currentColor\",\n              viewBox: \"0 0 24 24\",\n              children: /*#__PURE__*/_jsxDEV(\"path\", {\n                strokeLinecap: \"round\",\n                strokeLinejoin: \"round\",\n                strokeWidth: \"2\",\n                d: \"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 13.5c-.77.833.192 2.5 1.732 2.5z\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 509,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 503,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 502,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              className: \"error-title\",\n              children: \"Oops!\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 518,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"error-message\",\n              children: errorMessage\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 519,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 517,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 501,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: closeError,\n          className: \"error-close-button\",\n          children: \"Close\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 522,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 500,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 499,\n      columnNumber: 9\n    }, this), fileName && data.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"file-info-section\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"file-summary-card\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"file-summary-title\",\n          children: \"\\u2705 File Imported Successfully\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 534,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"file-stats-grid\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"stat-card\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"stat-label\",\n              children: \"File Name\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 539,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"stat-value\",\n              children: fileName\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 540,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 538,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"stat-card\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"stat-label\",\n              children: \"Total Rows\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 543,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"stat-value\",\n              children: data.length\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 544,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 542,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"stat-card\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"stat-label\",\n              children: \"Columns\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 547,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"stat-value\",\n              children: Object.keys(data[0]).length\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 548,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 546,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 537,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 533,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"projects-table-container\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"table-header\",\n          children: /*#__PURE__*/_jsxDEV(\"h4\", {\n            className: \"table-title\",\n            children: [\"\\uD83D\\uDCCB All Projects (\", data.length, \")\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 558,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 557,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"table-wrapper\",\n          children: /*#__PURE__*/_jsxDEV(\"table\", {\n            className: \"projects-table\",\n            children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n              children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"table-head-cell\",\n                  children: \"Select\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 564,\n                  columnNumber: 21\n                }, this), Object.keys(data[0]).map(key => {\n                  let displayName = key;\n                  if (normalizeString(key).includes(\"n° prix\")) displayName = \"Code\";else if (normalizeString(key).includes(\"designation\")) displayName = \"Désignation\";else if (normalizeString(key).includes(\"unite\")) displayName = \"Unité\";else if (normalizeString(key).includes(\"quantit\")) displayName = \"Qté\";else if (normalizeString(key).includes(\"p.u\")) displayName = \"P.U HT\";else if (normalizeString(key).includes(\"motant\")) displayName = \"Total HT\";else if (normalizeString(key).includes(\"description\")) displayName = \"Description (longue)\";\n                  return /*#__PURE__*/_jsxDEV(\"th\", {\n                    className: `table-head-cell ${normalizeString(key).includes(\"description\") ? \"description-column\" : \"\"}`,\n                    children: displayName\n                  }, key, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 583,\n                    columnNumber: 25\n                  }, this);\n                })]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 563,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 562,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n              children: data.map((row, index) => {\n                const keys = Object.keys(row);\n                return /*#__PURE__*/_jsxDEV(\"tr\", {\n                  className: \"table-row\",\n                  children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"table-cell\",\n                    children: /*#__PURE__*/_jsxDEV(\"input\", {\n                      type: \"checkbox\",\n                      checked: selectedRows.has(index),\n                      onChange: () => toggleRowSelection(index),\n                      className: \"select-checkbox\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 604,\n                      columnNumber: 27\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 603,\n                    columnNumber: 25\n                  }, this), Object.values(row).map((value, cellIndex) => {\n                    const key = keys[cellIndex];\n                    let displayValue = String(value);\n                    if (normalizeString(key).includes(\"description\") && displayValue.length > 50) {\n                      displayValue = displayValue.substring(0, 50) + \"...\";\n                    }\n                    return /*#__PURE__*/_jsxDEV(\"td\", {\n                      className: \"table-cell\",\n                      title: String(value),\n                      children: displayValue\n                    }, cellIndex, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 624,\n                      columnNumber: 29\n                    }, this);\n                  })]\n                }, index, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 602,\n                  columnNumber: 23\n                }, this);\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 598,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 561,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 560,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 556,\n        columnNumber: 11\n      }, this), selectedRows.size > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"selected-projects-container\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"table-header\",\n          children: /*#__PURE__*/_jsxDEV(\"h4\", {\n            className: \"table-title\",\n            children: [\"\\u2705 Selected Projects (\", selectedRows.size, \")\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 645,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 644,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"table-wrapper\",\n          children: /*#__PURE__*/_jsxDEV(\"table\", {\n            className: \"projects-table\",\n            children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n              children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"table-head-cell\",\n                  children: \"Id\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 653,\n                  columnNumber: 23\n                }, this), Object.keys(data[0]).filter(col => !normalizeString(col).includes(\"description\") && normalizeString(col) !== \"id\").map(key => /*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"table-head-cell\",\n                  children: key\n                }, key, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 661,\n                  columnNumber: 27\n                }, this))]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 652,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 651,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n              children: getSelectedData().map((row, index) => /*#__PURE__*/_jsxDEV(\"tr\", {\n                className: \"table-row\",\n                children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"table-cell\",\n                  children: index + 1\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 670,\n                  columnNumber: 25\n                }, this), Object.entries(row).map(([key, value]) => {\n                  if (normalizeString(key) === \"id\" || normalizeString(key).includes(\"description\")) return null;\n                  return /*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"table-cell\",\n                    children: String(value)\n                  }, key, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 678,\n                    columnNumber: 29\n                  }, this);\n                })]\n              }, index, true, {\n                fileName: _jsxFileName,\n                lineNumber: 669,\n                columnNumber: 23\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 667,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 650,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 649,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 643,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"export-section\",\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          className: \"export-title\",\n          children: \"\\uD83D\\uDCE4 Export Options\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 693,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"export-cards-grid\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"export-card excel-card\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"export-card-header\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"export-icon\",\n                children: \"\\uD83D\\uDCCA\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 698,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"h5\", {\n                className: \"export-card-title\",\n                children: \"Export Clean Excel\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 699,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 697,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"export-card-description\",\n              children: \"Exports selected rows without the description column \\u2014 perfect for data processing or sharing.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 701,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: exportExcelFile,\n              className: \"export-button excel-button\",\n              children: \"\\uD83D\\uDCCA Export Excel\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 705,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 696,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"export-card word-card\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"export-card-header\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"export-icon\",\n                children: \"\\uD83D\\uDCDD\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 716,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"h5\", {\n                className: \"export-card-title\",\n                children: \"Export Descriptions to Word\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 717,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 715,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"export-card-description\",\n              children: \"Exports project IDs, titles, and full descriptions in a beautifully formatted Word document.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 721,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: exportWordFile,\n              className: \"export-button word-button\",\n              children: \"\\uD83D\\uDCDD Export Word\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 725,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 714,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 694,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 692,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 531,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 472,\n    columnNumber: 5\n  }, this);\n};\n_s(ExcelWordExporter, \"DrqUQpx5xRmLnhtEmYZC9NoJjX0=\");\n_c = ExcelWordExporter;\nexport default ExcelWordExporter;\nvar _c;\n$RefreshReg$(_c, \"ExcelWordExporter\");","map":{"version":3,"names":["React","useState","useRef","XLSX","PizZip","Docxtemplater","save","writeBinaryFile","open","dirname","saveAs","jsxDEV","_jsxDEV","isTauri","window","__TAURI__","saveFile","blob","fileName","console","log","filePath","title","defaultPath","filters","name","endsWith","extensions","split","pop","alert","arrayBuffer","uint8Array","Uint8Array","folderPath","error","message","normalizeString","str","normalize","replace","toLowerCase","trim","ExcelWordExporter","_s","data","setData","selectedRows","setSelectedRows","Set","setFileName","showError","setShowError","errorMessage","setErrorMessage","fileInputRef","handleFileImport","_fileInputRef$current","current","click","handleFileChange","event","file","target","files","validExtensions","fileExtension","slice","lastIndexOf","includes","value","reader","FileReader","onload","e","result","workbook","read","type","firstSheetName","SheetNames","worksheet","Sheets","range","utils","decode_range","raw_data","R","s","r","row","C","c","cell_address","cell_ref","encode_cell","cell","push","w","v","headerRowIndex","i","length","Array","isArray","some","Error","headers","dataRows","jsonData","filter","map","obj","forEach","header","index","key","Object","values","val","String","readAsArrayBuffer","closeError","toggleRowSelection","newSelected","has","delete","add","getSelectedData","_","headerStyle","fill","fgColor","rgb","font","color","bold","sz","alignment","horizontal","vertical","wrapText","border","top","style","bottom","left","right","cellStyle","numberStyle","numFmt","exportExcelFile","selected","parseNumber","num","parseFloat","isNaN","nPrixCol","keys","find","col","titleCol","unitCol","qtyCol","priceCol","totalCol","excelData","qty","price","totalFromSource","Désignation","Unité","Quantité","ws","json_to_sheet","skipHeader","columns","wch","colIndex","cellAddress","rowIndex","t","Number","wb","book_new","book_append_sheet","exportFileName","excelBuffer","write","bookType","success","exportWordFile","templateResponse","fetch","ok","templateArrayBuffer","zip","doc","paragraphLoop","linebreaks","descCol","projects","indexId","id","descriptif","render","getZip","generate","mimeType","wordFileName","className","children","_jsxFileName","lineNumber","columnNumber","onClick","ref","accept","onChange","stroke","viewBox","strokeLinecap","strokeLinejoin","strokeWidth","d","displayName","checked","cellIndex","displayValue","substring","size","entries","_c","$RefreshReg$"],"sources":["/home/ali/Desktop/applications/src/ExcelWordExporter.js"],"sourcesContent":["import React, { useState, useRef } from \"react\";\nimport * as XLSX from \"xlsx-js-style\";\n\nimport PizZip from \"pizzip\";\nimport Docxtemplater from \"docxtemplater\";\n// dectects tauri app folder\nimport { save } from \"@tauri-apps/api/dialog\";\nimport { writeBinaryFile } from \"@tauri-apps/api/fs\";\nimport { open } from \"@tauri-apps/api/shell\";\nimport { dirname } from \"@tauri-apps/api/path\";\nimport { saveAs } from \"file-saver\"; // 👈 already imported in your original code\n\nconst isTauri = () => {\n  return (\n    typeof window !== \"undefined\" &&\n    \"__TAURI__\" in window &&\n    typeof window.__TAURI__ !== \"undefined\"\n  );\n};\n// 👇 Universal file saver — works in browser AND Tauri\n// ✅ MOVE THESE TO THE TOP OF YOUR FILE (STATIC IMPORTS)\n// ✅ NEW & IMPROVED saveFile FUNCTION\nasync function saveFile(blob, fileName) {\n  try {\n    if (isTauri()) {\n      console.log(\"🚀 Tauri detected — opening save dialog...\");\n\n      // 👇 SHOW NATIVE SAVE DIALOG\n      const filePath = await save({\n        title: \"Save File\", // 👈 optional but user-friendly\n        defaultPath: fileName,\n        filters: [\n          {\n            name: fileName.endsWith(\".xlsx\") ? \"Excel File\" : \"Word Document\",\n            extensions: [fileName.split(\".\").pop()], // 👈 dynamic based on file\n          },\n        ],\n      });\n\n      // 👇 USER CANCELED\n      if (!filePath) {\n        console.log(\"❌ User canceled save dialog\");\n        alert(\"Export canceled — no file was saved.\");\n        return;\n      }\n\n      console.log(`✅ Saving to: ${filePath}`);\n\n      // 👇 CONVERT BLOB → ARRAYBUFFER → UINT8ARRAY (no Array.from needed)\n      const arrayBuffer = await blob.arrayBuffer();\n      const uint8Array = new Uint8Array(arrayBuffer);\n\n      // 👇 WRITE FILE\n      await writeBinaryFile(filePath, uint8Array);\n\n      // 👇 OPTIONAL: OPEN FOLDER AFTER SAVING\n      const folderPath = await dirname(filePath);\n      await open(folderPath);\n\n      alert(`✅ File saved successfully!\\n📁 ${filePath}`);\n    } else {\n      // 🌐 BROWSER FALLBACK\n      console.log(\"🌐 Browser detected — downloading file...\");\n      saveAs(blob, fileName);\n    }\n  } catch (error) {\n    console.error(\"🚨 Save failed:\", error);\n    alert(`Export failed: ${error.message || \"Unknown error\"}`);\n  }\n}\n\n// 👇 Helper function to normalize strings (remove accents, lowercase, clean spaces)\nconst normalizeString = (str) => {\n  if (typeof str !== \"string\") return \"\";\n  return str\n    .normalize(\"NFD\") // Split accented characters\n    .replace(/[\\u0300-\\u036f]/g, \"\") // Remove diacritics\n    .toLowerCase()\n    .trim()\n    .replace(/\\s+/g, \" \"); // Collapse spaces\n};\n\nconst ExcelWordExporter = () => {\n  const [data, setData] = useState([]);\n  const [selectedRows, setSelectedRows] = useState(new Set());\n  const [fileName, setFileName] = useState(\"\");\n  const [showError, setShowError] = useState(false);\n  const [errorMessage, setErrorMessage] = useState(\"\");\n  const fileInputRef = useRef(null);\n\n  // Handle file import\n  const handleFileImport = () => {\n    fileInputRef.current?.click();\n  };\n\n  // Handles any given extra column at the beginning so we can find the first column index:\n  // N° PRIX\n  const handleFileChange = (event) => {\n    const file = event.target.files[0];\n    if (!file) return;\n\n    const validExtensions = [\".xlsx\", \".xls\", \".csv\"];\n    const fileExtension = file.name\n      .toLowerCase()\n      .slice(file.name.lastIndexOf(\".\"));\n\n    if (!validExtensions.includes(fileExtension)) {\n      setErrorMessage(\n        `Invalid file type. Please select an Excel file (.xlsx, .xls, or .csv). You selected: ${fileExtension}`\n      );\n      setShowError(true);\n      event.target.value = \"\";\n      return;\n    }\n\n    const reader = new FileReader();\n    reader.onload = (e) => {\n      try {\n        const data = new Uint8Array(e.target.result);\n        const workbook = XLSX.read(data, { type: \"array\" });\n        const firstSheetName = workbook.SheetNames[0];\n        const worksheet = workbook.Sheets[firstSheetName];\n\n        // ✅ Read sheet as 2D array — with empty string fallback\n        const range = XLSX.utils.decode_range(worksheet[\"!ref\"]);\n        const raw_data = [];\n        for (let R = range.s.r; R <= range.e.r; ++R) {\n          const row = [];\n          for (let C = range.s.c; C <= range.e.c; ++C) {\n            const cell_address = { c: C, r: R };\n            const cell_ref = XLSX.utils.encode_cell(cell_address);\n            const cell = worksheet[cell_ref];\n            row.push(cell ? cell.w || cell.v : \"\"); // ← Use formatted (w) or raw (v) value\n          }\n          raw_data.push(row);\n        }\n\n        // ✅ Find header row — look for \"N° PRIX\"\n        let headerRowIndex = -1;\n        for (let i = 0; i < raw_data.length; i++) {\n          const row = raw_data[i];\n          if (\n            Array.isArray(row) &&\n            row.some(\n              (cell) =>\n                typeof cell === \"string\" &&\n                normalizeString(cell).includes(\"n° prix\")\n            )\n          ) {\n            headerRowIndex = i;\n            break;\n          }\n        }\n\n        if (headerRowIndex === -1) {\n          throw new Error(\n            \"Could not detect header row. Please make sure 'N° PRIX' column exists.\"\n          );\n        }\n\n        // ✅ Extract headers and data rows\n        const headers = raw_data[headerRowIndex];\n        const dataRows = raw_data.slice(headerRowIndex + 1);\n\n        // ✅ Convert to array of objects — with normalized keys\n        const jsonData = dataRows\n          .filter((row) => row && row.length > 0)\n          .map((row) => {\n            const obj = {};\n            headers.forEach((header, index) => {\n              const key = normalizeString(header || `col_${index}`);\n              obj[key] = index < row.length ? row[index] : \"\";\n            });\n            return obj;\n          })\n          .filter((obj) =>\n            Object.values(obj).some((val) => String(val).trim() !== \"\")\n          );\n\n        if (jsonData.length === 0) {\n          throw new Error(\"No valid data found after header row.\");\n        }\n\n        setData(jsonData);\n        setFileName(file.name);\n        setShowError(false);\n      } catch (error) {\n        console.error(\"File Read Error:\", error);\n        setErrorMessage(\n          error.message || \"Error reading Excel file. Please check format.\"\n        );\n        setShowError(true);\n      }\n    };\n    reader.readAsArrayBuffer(file);\n  };\n\n  const closeError = () => {\n    setShowError(false);\n    setErrorMessage(\"\");\n  };\n\n  // Toggle row selection\n  const toggleRowSelection = (index) => {\n    const newSelected = new Set(selectedRows);\n    if (newSelected.has(index)) {\n      newSelected.delete(index);\n    } else {\n      newSelected.add(index);\n    }\n    setSelectedRows(newSelected);\n  };\n\n  // Get selected data\n  const getSelectedData = () => {\n    return data.filter((_, index) => selectedRows.has(index));\n  };\n\n  // 🎨 Excel Styles\n  const headerStyle = {\n    fill: { fgColor: { rgb: \"43A047\" } }, // Dark blue\n    font: { color: { rgb: \"000000\" }, bold: true, sz: 15 },\n    alignment: { horizontal: \"center\", vertical: \"center\", wrapText: true },\n    border: {\n      top: { style: \"thin\", color: { rgb: \"000000\" } },\n      bottom: { style: \"thin\", color: { rgb: \"000000\" } },\n      left: { style: \"thin\", color: { rgb: \"000000\" } },\n      right: { style: \"thin\", color: { rgb: \"000000\" } },\n    },\n  };\n\n  const cellStyle = {\n    alignment: { horizontal: \"left\", vertical: \"top\", wrapText: true },\n    border: {\n      top: { style: \"thin\", color: { rgb: \"D9D9D9\" } },\n      bottom: { style: \"thin\", color: { rgb: \"D9D9D9\" } },\n      left: { style: \"thin\", color: { rgb: \"D9D9D9\" } },\n      right: { style: \"thin\", color: { rgb: \"D9D9D9\" } },\n    },\n    font: { sz: 11 },\n  };\n\n  const numberStyle = {\n    ...cellStyle,\n    alignment: { horizontal: \"right\", vertical: \"top\" },\n    numFmt: \"#,##0.00\",\n  };\n\n  // Export Excel (without description) — with sequential ID reset + STYLING\n  const exportExcelFile = async () => {\n    const selected = getSelectedData();\n    if (selected.length === 0) {\n      setErrorMessage(\"No rows selected. Please select at least one row.\");\n      setShowError(true);\n      return;\n    }\n\n    try {\n      // Detect columns dynamically — using normalized search\n      const parseNumber = (value) => {\n        const num = parseFloat(value);\n        return !isNaN(num) ? num : 0;\n      };\n      const nPrixCol =\n        Object.keys(data[0]).find((col) =>\n          normalizeString(col).includes(\"n° prix\")\n        ) || normalizeString(\"N° Prix\");\n      const titleCol =\n        Object.keys(data[0]).find((col) =>\n          normalizeString(col).includes(\"designation\")\n        ) || normalizeString(\"designation des ouvrages\");\n      const unitCol =\n        Object.keys(data[0]).find((col) =>\n          normalizeString(col).includes(\"unite\")\n        ) || normalizeString(\"unite\");\n      const qtyCol =\n        Object.keys(data[0]).find((col) =>\n          normalizeString(col).includes(\"quantite\")\n        ) || normalizeString(\"quantites\");\n      const priceCol =\n        Object.keys(data[0]).find((col) =>\n          normalizeString(col).includes(\"p.u\")\n        ) || normalizeString(\"p.u dh.ht\");\n      const totalCol =\n        Object.keys(data[0]).find((col) =>\n          normalizeString(col).includes(\"montant total h.t\")\n        ) || normalizeString(\"Montant total H.T\");\n\n      // Prepare data\n      const excelData = selected.map((row) => {\n        const qty = parseNumber(row[qtyCol]);\n        const price = parseNumber(row[priceCol]);\n        const totalFromSource = parseNumber(row[totalCol]);\n\n        return {\n          \"N°Prix\": row[nPrixCol] || \"\", // ← PRESERVE ORIGINAL VALUE (A, a, 1, 2, B, etc.)\n          Désignation: row[titleCol] || \"Sans Titre\",\n          Unité: row[unitCol] || \"\",\n          Quantité: qty,\n          \"P.U DH.HT\": price,\n          \"Montant Total HT\": totalFromSource || qty * price,\n        };\n      });\n\n      // Create worksheet\n      const ws = XLSX.utils.json_to_sheet(excelData, { skipHeader: true });\n\n      // Define columns\n      const headers = [\n        \"N°Prix\",\n        \"Désignation\",\n        \"Unité\",\n        \"Quantité\",\n        \"P.U DH.HT\",\n        \"Montant Total HT\",\n      ];\n\n      const columns = [\n        { wch: 8 }, // N°Prix\n        { wch: 40 }, // Désignation\n        { wch: 10 }, // Unité\n        { wch: 12 }, // Quantité\n        { wch: 15 }, // P.U DH.HT\n        { wch: 18 }, // Montant Total HT\n      ];\n      ws[\"!cols\"] = columns;\n\n      // Add styled headers\n      headers.forEach((header, colIndex) => {\n        const cellAddress = XLSX.utils.encode_cell({ r: 0, c: colIndex });\n        ws[cellAddress] = { v: header, s: headerStyle };\n      });\n\n      // Style data cells\n      for (let rowIndex = 1; rowIndex <= excelData.length; rowIndex++) {\n        for (let colIndex = 0; colIndex < headers.length; colIndex++) {\n          const cellAddress = XLSX.utils.encode_cell({\n            r: rowIndex,\n            c: colIndex,\n          });\n          if (!ws[cellAddress]) continue;\n\n          if ([3, 4, 5].includes(colIndex)) {\n            // Numeric columns\n            ws[cellAddress].s = numberStyle;\n            ws[cellAddress].t = \"n\";\n            ws[cellAddress].v = Number(ws[cellAddress].v);\n          } else {\n            ws[cellAddress].s = cellStyle;\n          }\n        }\n      }\n\n      // Finalize and export\n      const wb = XLSX.utils.book_new();\n      XLSX.utils.book_append_sheet(wb, ws, \"Selected Projects\");\n\n      const exportFileName = fileName\n        ? `export_${fileName.replace(/\\.[^/.]+$/, \"\")}.xlsx`\n        : \"project_export.xlsx\";\n\n      // ✅ START REPLACEMENT — Replace XLSX.writeFile with this block\n      // ✅ Generate buffer (same as before)\n      const excelBuffer = XLSX.write(wb, { bookType: \"xlsx\", type: \"array\" });\n      const uint8Array = new Uint8Array(excelBuffer);\n\n      // ✅ Use universal saver\n      const success = await saveFile(\n        uint8Array,\n        exportFileName,\n        \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"\n      );\n\n      if (!success) {\n        setErrorMessage(\"Export canceled by user.\");\n        setShowError(true);\n        return;\n      }\n\n      alert(`✅ Excel exported successfully!`);\n\n      // ✅ END REPLACEMENT\n    } catch (error) {\n      console.error(\"Export Excel Error:\", error);\n      setErrorMessage(\"Error exporting Excel file.\");\n      setShowError(true);\n    }\n  };\n\n  // Export Word (with description) — FIXED\n  const exportWordFile = async () => {\n    const selected = getSelectedData();\n    if (selected.length === 0) {\n      setErrorMessage(\"No rows selected. Please select at least one row.\");\n      setShowError(true);\n      return;\n    }\n\n    try {\n      // Load the official template\n      const templateResponse = await fetch(\"/templates/ROYAUME_DU_MAROC.docx\");\n      if (!templateResponse.ok) {\n        setErrorMessage(\"Could not load the royaume template\");\n        setShowError(true);\n        return;\n      }\n      const templateArrayBuffer = await templateResponse.arrayBuffer();\n\n      // Initialize docxtemplater\n      const zip = new PizZip(templateArrayBuffer);\n      const doc = new Docxtemplater(zip, {\n        paragraphLoop: true,\n        linebreaks: true,\n      });\n\n      // 🔍 Detect columns dynamically — with normalization\n      const titleCol =\n        Object.keys(data[0]).find((col) =>\n          normalizeString(col).includes(\"designation\")\n        ) || \"designation des ouvrages\";\n\n      const descCol =\n        Object.keys(data[0]).find((col) =>\n          normalizeString(col).includes(\"descriptif\")\n        ) || \"descriptif\";\n\n      // Prepare data\n      const projects = selected.map((row, indexId) => ({\n        id: indexId + 1,\n        title: row[titleCol] || \"Sans Titre\",\n        descriptif: row[descCol] || \"\",\n      }));\n      //.filter((project) => project.descriptif.trim() !== \"\"); // ← Skip if empty or only whitespace\n      // Inject data\n      doc.setData({ projects });\n\n      // Render\n      doc.render();\n\n      // Generate and save\n      const blob = doc.getZip().generate({\n        type: \"blob\",\n        mimeType:\n          \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\",\n      });\n      const wordFileName = fileName\n        ? `descriptions_${fileName.replace(/\\.[^/.]+$/, \"\")}.docx`\n        : \"project_descriptions.docx\";\n\n      const success = await saveFile(\n        await blob.arrayBuffer(),\n        wordFileName,\n        \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\"\n      );\n\n      if (!success) {\n        setErrorMessage(\"Export canceled by user.\");\n        setShowError(true);\n        return;\n      }\n\n      alert(`✅ Word document exported successfully!`);\n    } catch (error) {\n      console.error(\"🚨 docxtemplater Error:\", error);\n      setErrorMessage(`Export failed: ${error.message || \"Unknown error\"}`);\n      setShowError(true);\n    }\n  };\n\n  // where the app begins\n  return (\n    <div className=\"app-container\">\n      {/* Header Section */}\n      <div className=\"header-section\">\n        <h1 className=\"header-title\">📊 Project Data Selector & Exporter</h1>\n        <p className=\"header-subtitle\">\n          Import your Excel file, select the projects you want, and export clean\n          data or rich descriptions — all in a few clicks.\n        </p>\n      </div>\n\n      {/* Import Button */}\n      <div className=\"import-button-wrapper\">\n        <button onClick={handleFileImport} className=\"import-button\">\n          📁 Import Excel File\n        </button>\n      </div>\n\n      <input\n        className=\"hidden\"\n        ref={fileInputRef}\n        type=\"file\"\n        accept=\".xlsx,.xls,.csv\"\n        onChange={handleFileChange}\n      />\n\n      {/* Error Modal */}\n      {showError && (\n        <div className=\"error-modal-overlay\">\n          <div className=\"error-modal\">\n            <div className=\"error-modal-header\">\n              <div className=\"error-icon\">\n                <svg\n                  className=\"error-svg\"\n                  fill=\"none\"\n                  stroke=\"currentColor\"\n                  viewBox=\"0 0 24 24\"\n                >\n                  <path\n                    strokeLinecap=\"round\"\n                    strokeLinejoin=\"round\"\n                    strokeWidth=\"2\"\n                    d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 13.5c-.77.833.192 2.5 1.732 2.5z\"\n                  />\n                </svg>\n              </div>\n              <div>\n                <h3 className=\"error-title\">Oops!</h3>\n                <p className=\"error-message\">{errorMessage}</p>\n              </div>\n            </div>\n            <button onClick={closeError} className=\"error-close-button\">\n              Close\n            </button>\n          </div>\n        </div>\n      )}\n\n      {/* File Info & Data Table */}\n      {fileName && data.length > 0 && (\n        <div className=\"file-info-section\">\n          {/* File Summary Card */}\n          <div className=\"file-summary-card\">\n            <h3 className=\"file-summary-title\">\n              ✅ File Imported Successfully\n            </h3>\n            <div className=\"file-stats-grid\">\n              <div className=\"stat-card\">\n                <span className=\"stat-label\">File Name</span>\n                <span className=\"stat-value\">{fileName}</span>\n              </div>\n              <div className=\"stat-card\">\n                <span className=\"stat-label\">Total Rows</span>\n                <span className=\"stat-value\">{data.length}</span>\n              </div>\n              <div className=\"stat-card\">\n                <span className=\"stat-label\">Columns</span>\n                <span className=\"stat-value\">\n                  {Object.keys(data[0]).length}\n                </span>\n              </div>\n            </div>\n          </div>\n\n          {/* Full Projects Table */}\n          <div className=\"projects-table-container\">\n            <div className=\"table-header\">\n              <h4 className=\"table-title\">📋 All Projects ({data.length})</h4>\n            </div>\n            <div className=\"table-wrapper\">\n              <table className=\"projects-table\">\n                <thead>\n                  <tr>\n                    <th className=\"table-head-cell\">Select</th>\n                    {Object.keys(data[0]).map((key) => {\n                      let displayName = key;\n                      if (normalizeString(key).includes(\"n° prix\"))\n                        displayName = \"Code\";\n                      else if (normalizeString(key).includes(\"designation\"))\n                        displayName = \"Désignation\";\n                      else if (normalizeString(key).includes(\"unite\"))\n                        displayName = \"Unité\";\n                      else if (normalizeString(key).includes(\"quantit\"))\n                        displayName = \"Qté\";\n                      else if (normalizeString(key).includes(\"p.u\"))\n                        displayName = \"P.U HT\";\n                      else if (normalizeString(key).includes(\"motant\"))\n                        displayName = \"Total HT\";\n                      else if (normalizeString(key).includes(\"description\"))\n                        displayName = \"Description (longue)\";\n\n                      return (\n                        <th\n                          key={key}\n                          className={`table-head-cell ${\n                            normalizeString(key).includes(\"description\")\n                              ? \"description-column\"\n                              : \"\"\n                          }`}\n                        >\n                          {displayName}\n                        </th>\n                      );\n                    })}\n                  </tr>\n                </thead>\n\n                <tbody>\n                  {data.map((row, index) => {\n                    const keys = Object.keys(row);\n                    return (\n                      <tr key={index} className=\"table-row\">\n                        <td className=\"table-cell\">\n                          <input\n                            type=\"checkbox\"\n                            checked={selectedRows.has(index)}\n                            onChange={() => toggleRowSelection(index)}\n                            className=\"select-checkbox\"\n                          />\n                        </td>\n                        {Object.values(row).map((value, cellIndex) => {\n                          const key = keys[cellIndex];\n                          let displayValue = String(value);\n\n                          if (\n                            normalizeString(key).includes(\"description\") &&\n                            displayValue.length > 50\n                          ) {\n                            displayValue =\n                              displayValue.substring(0, 50) + \"...\";\n                          }\n\n                          return (\n                            <td\n                              key={cellIndex}\n                              className=\"table-cell\"\n                              title={String(value)}\n                            >\n                              {displayValue}\n                            </td>\n                          );\n                        })}\n                      </tr>\n                    );\n                  })}\n                </tbody>\n              </table>\n            </div>\n          </div>\n\n          {/* Selected Projects Preview */}\n          {selectedRows.size > 0 && (\n            <div className=\"selected-projects-container\">\n              <div className=\"table-header\">\n                <h4 className=\"table-title\">\n                  ✅ Selected Projects ({selectedRows.size})\n                </h4>\n              </div>\n              <div className=\"table-wrapper\">\n                <table className=\"projects-table\">\n                  <thead>\n                    <tr>\n                      <th className=\"table-head-cell\">Id</th>\n                      {Object.keys(data[0])\n                        .filter(\n                          (col) =>\n                            !normalizeString(col).includes(\"description\") &&\n                            normalizeString(col) !== \"id\"\n                        )\n                        .map((key) => (\n                          <th key={key} className=\"table-head-cell\">\n                            {key}\n                          </th>\n                        ))}\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {getSelectedData().map((row, index) => (\n                      <tr key={index} className=\"table-row\">\n                        <td className=\"table-cell\">{index + 1}</td>\n                        {Object.entries(row).map(([key, value]) => {\n                          if (\n                            normalizeString(key) === \"id\" ||\n                            normalizeString(key).includes(\"description\")\n                          )\n                            return null;\n                          return (\n                            <td key={key} className=\"table-cell\">\n                              {String(value)}\n                            </td>\n                          );\n                        })}\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n            </div>\n          )}\n\n          {/* Export Options */}\n          <div className=\"export-section\">\n            <h4 className=\"export-title\">📤 Export Options</h4>\n            <div className=\"export-cards-grid\">\n              {/* Excel Export Card */}\n              <div className=\"export-card excel-card\">\n                <div className=\"export-card-header\">\n                  <div className=\"export-icon\">📊</div>\n                  <h5 className=\"export-card-title\">Export Clean Excel</h5>\n                </div>\n                <p className=\"export-card-description\">\n                  Exports selected rows without the description column — perfect\n                  for data processing or sharing.\n                </p>\n                <button\n                  onClick={exportExcelFile}\n                  className=\"export-button excel-button\"\n                >\n                  📊 Export Excel\n                </button>\n              </div>\n\n              {/* Word Export Card */}\n              <div className=\"export-card word-card\">\n                <div className=\"export-card-header\">\n                  <div className=\"export-icon\">📝</div>\n                  <h5 className=\"export-card-title\">\n                    Export Descriptions to Word\n                  </h5>\n                </div>\n                <p className=\"export-card-description\">\n                  Exports project IDs, titles, and full descriptions in a\n                  beautifully formatted Word document.\n                </p>\n                <button\n                  onClick={exportWordFile}\n                  className=\"export-button word-button\"\n                >\n                  📝 Export Word\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default ExcelWordExporter;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}